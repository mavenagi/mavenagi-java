/**
 * This file was auto-generated by Fern from our API Definition.
 */
package com.mavenagi.resources.commons.types;

import com.fasterxml.jackson.annotation.JsonAnyGetter;
import com.fasterxml.jackson.annotation.JsonAnySetter;
import com.fasterxml.jackson.annotation.JsonIgnoreProperties;
import com.fasterxml.jackson.annotation.JsonInclude;
import com.fasterxml.jackson.annotation.JsonProperty;
import com.fasterxml.jackson.annotation.JsonSetter;
import com.fasterxml.jackson.annotation.Nulls;
import com.fasterxml.jackson.databind.annotation.JsonDeserialize;
import com.mavenagi.core.ObjectMappers;
import java.util.HashMap;
import java.util.Map;
import java.util.Objects;
import java.util.Optional;
import java.util.Set;

@JsonInclude(JsonInclude.Include.NON_ABSENT)
@JsonDeserialize(builder = SimulationContext.Builder.class)
public final class SimulationContext {
    private final Optional<String> additionalPromptText;

    private final Optional<LlmPersona> persona;

    private final Optional<Set<EntityId>> availableKnowledgeBases;

    private final Map<String, Object> additionalProperties;

    private SimulationContext(
            Optional<String> additionalPromptText,
            Optional<LlmPersona> persona,
            Optional<Set<EntityId>> availableKnowledgeBases,
            Map<String, Object> additionalProperties) {
        this.additionalPromptText = additionalPromptText;
        this.persona = persona;
        this.availableKnowledgeBases = availableKnowledgeBases;
        this.additionalProperties = additionalProperties;
    }

    /**
     * @return If provided, overrides the agent's default additional prompt text during the simulation.
     * Note that this field is provided for backwards compatibility and will be removed in a future release.
     * Instead please use the <code>availableKnowledgeBases</code> field to include a knowledge base with a document <code>llmInclusionStatus</code> set to <code>ALWAYS</code>.
     */
    @JsonProperty("additionalPromptText")
    public Optional<String> getAdditionalPromptText() {
        return additionalPromptText;
    }

    /**
     * @return The persona to use during the simulation. If not provided, the agent's default persona will be used.
     */
    @JsonProperty("persona")
    public Optional<LlmPersona> getPersona() {
        return persona;
    }

    /**
     * @return If provided, knowledge search will be restricted to the provided list of knowledge bases. Otherwise, all active knowledge bases will be used. An empty list means no knowledge bases will be used.
     */
    @JsonProperty("availableKnowledgeBases")
    public Optional<Set<EntityId>> getAvailableKnowledgeBases() {
        return availableKnowledgeBases;
    }

    @java.lang.Override
    public boolean equals(Object other) {
        if (this == other) return true;
        return other instanceof SimulationContext && equalTo((SimulationContext) other);
    }

    @JsonAnyGetter
    public Map<String, Object> getAdditionalProperties() {
        return this.additionalProperties;
    }

    private boolean equalTo(SimulationContext other) {
        return additionalPromptText.equals(other.additionalPromptText)
                && persona.equals(other.persona)
                && availableKnowledgeBases.equals(other.availableKnowledgeBases);
    }

    @java.lang.Override
    public int hashCode() {
        return Objects.hash(this.additionalPromptText, this.persona, this.availableKnowledgeBases);
    }

    @java.lang.Override
    public String toString() {
        return ObjectMappers.stringify(this);
    }

    public static Builder builder() {
        return new Builder();
    }

    @JsonIgnoreProperties(ignoreUnknown = true)
    public static final class Builder {
        private Optional<String> additionalPromptText = Optional.empty();

        private Optional<LlmPersona> persona = Optional.empty();

        private Optional<Set<EntityId>> availableKnowledgeBases = Optional.empty();

        @JsonAnySetter
        private Map<String, Object> additionalProperties = new HashMap<>();

        private Builder() {}

        public Builder from(SimulationContext other) {
            additionalPromptText(other.getAdditionalPromptText());
            persona(other.getPersona());
            availableKnowledgeBases(other.getAvailableKnowledgeBases());
            return this;
        }

        /**
         * <p>If provided, overrides the agent's default additional prompt text during the simulation.
         * Note that this field is provided for backwards compatibility and will be removed in a future release.
         * Instead please use the <code>availableKnowledgeBases</code> field to include a knowledge base with a document <code>llmInclusionStatus</code> set to <code>ALWAYS</code>.</p>
         */
        @JsonSetter(value = "additionalPromptText", nulls = Nulls.SKIP)
        public Builder additionalPromptText(Optional<String> additionalPromptText) {
            this.additionalPromptText = additionalPromptText;
            return this;
        }

        public Builder additionalPromptText(String additionalPromptText) {
            this.additionalPromptText = Optional.ofNullable(additionalPromptText);
            return this;
        }

        /**
         * <p>The persona to use during the simulation. If not provided, the agent's default persona will be used.</p>
         */
        @JsonSetter(value = "persona", nulls = Nulls.SKIP)
        public Builder persona(Optional<LlmPersona> persona) {
            this.persona = persona;
            return this;
        }

        public Builder persona(LlmPersona persona) {
            this.persona = Optional.ofNullable(persona);
            return this;
        }

        /**
         * <p>If provided, knowledge search will be restricted to the provided list of knowledge bases. Otherwise, all active knowledge bases will be used. An empty list means no knowledge bases will be used.</p>
         */
        @JsonSetter(value = "availableKnowledgeBases", nulls = Nulls.SKIP)
        public Builder availableKnowledgeBases(Optional<Set<EntityId>> availableKnowledgeBases) {
            this.availableKnowledgeBases = availableKnowledgeBases;
            return this;
        }

        public Builder availableKnowledgeBases(Set<EntityId> availableKnowledgeBases) {
            this.availableKnowledgeBases = Optional.ofNullable(availableKnowledgeBases);
            return this;
        }

        public SimulationContext build() {
            return new SimulationContext(additionalPromptText, persona, availableKnowledgeBases, additionalProperties);
        }
    }
}
